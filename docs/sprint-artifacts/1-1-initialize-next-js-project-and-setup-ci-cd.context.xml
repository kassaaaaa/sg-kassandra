<story-context id="{bmad_folder}/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>1</epicId>
    <storyId>1</storyId>
    <title>Initialize Next.js Project and Setup CI/CD</title>
    <status>drafted</status>
    <generatedAt>2025-12-02</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/sprint-artifacts/1-1-initialize-next-js-project-and-setup-ci-cd.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>As a Developer,</asA>
    <iWant>I want to initialize the Next.js application and configure the basic CI/CD pipeline,</iWant>
    <soThat>so that we have a consistent and automated foundation for development and deployment.</soThat>
    <tasks>
      - [ ] Task 1 (AC: #1)
        - [ ] Run `npx create-next-app@latest . --typescript --tailwind --eslint`.
        - [ ] **Test:** Write a `Vitest` unit test to check that `package.json` contains `typescript`, `tailwindcss`, and `eslint` as dependencies.
        - [ ] **Test:** Write a `Vitest` unit test to verify that `tailwind.config.ts` and `.eslintrc.json` files exist at the root.
      - [ ] Task 2 (AC: #2)
        - [ ] Create a new project on Vercel.
        - [ ] Connect the Vercel project to the project's git repository.
        - [ ] **Test (Manual):** Confirm that the Vercel project dashboard shows the repository as connected.
      - [ ] Task 3 (AC: #3)
        - [ ] Configure the Vercel project to run `npm run lint` and `npm run test` on each deployment.
        - [ ] Ensure the main branch is automatically deployed to production.
        - [ ] **Test:** After a push to a PR, inspect the Vercel deployment logs to confirm that the `lint` and `test` commands were executed.
        - [ ] **Test (E2E):** Write a basic `Playwright` test that navigates to the deployed Vercel URL and verifies the presence of a key element (e.g., the Next.js welcome page `<h1>`). The CI should run this test post-deployment.
    </tasks>
  </story>

  <acceptanceCriteria>
    1. The root directory is initialized as a Next.js project with TypeScript, Tailwind CSS, and ESLint configured.
    2. The project is connected to a Vercel account for automated deployments.
    3. A basic CI pipeline is configured to run linting and tests on every push to the main branch.
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/fase-3-solution/architecture.md</path>
        <title>Architecture Document</title>
        <section>2. Project Initialization</section>
        <snippet>
          The project will be initialized using the official Next.js starter template, `create-next-app`.
          The full initialization command...will be: `npx create-next-app@latest kiteops-app --typescript --tailwind --eslint`.
        </snippet>
      </doc>
      <doc>
        <path>docs/sprint-artifacts/tech-spec-epic-1.md</path>
        <title>Epic Technical Specification: Foundation, Authentication, and Instructor Profiles</title>
        <section>Acceptance Criteria (Authoritative) - Story 1.1</section>
        <snippet>
          AC1.1.1: The project is initialized as a Next.js application...with TypeScript, Tailwind CSS, and ESLint configured.
          AC1.1.2: The project is connected to a Vercel account for automated deployments.
          AC1.1.3: A basic CI pipeline is configured to run linting and tests on every push to the main branch.
        </snippet>
      </doc>
      <doc>
        <path>docs/sprint-artifacts/tech-spec-epic-1.md</path>
        <title>Epic Technical Specification: Foundation, Authentication, and Instructor Profiles</title>
        <section>System Architecture Alignment</section>
        <snippet>
            Epic 1 is foundational and directly aligns with the core architectural decisions...
            Next.js (Frontend)...
            Supabase (Backend)...
            Tailwind CSS &amp; shadcn/ui...
            Vercel...
        </snippet>
      </doc>
      <doc>
        <path>docs/fase-3-solution/epics.md</path>
        <title>ibe160 - Epic Breakdown</title>
        <section>Epic 1: Story 1.1</section>
        <snippet>
          As a Developer, I want to initialize the Next.js application and configure the basic CI/CD pipeline...
          Technical Notes: Use the command `npx create-next-app@latest . --typescript --tailwind --eslint` as specified in `architecture.md`.
        </snippet>
      </doc>
      <doc>
        <path>docs/fase-2-plan/ux-design-specification.md</path>
        <title>UX Design Specification</title>
        <section>2.1. Design System</section>
        <snippet>
          Chosen System: shadcn/ui...
          Rationale: Selected for its seamless integration with Tailwind CSS and Next.js...
        </snippet>
      </doc>
    </docs>
    <code>
      <!-- No existing code artifacts relevant to this story. This story initializes the project. -->
    </code>
    <dependencies>
      <ecosystem name="Node.js">
        <package name="next" version="16.0.6" />
        <package name="typescript" version="5.9.3" />
        <package name="tailwindcss" version="4.1.17" />
        <package name="shadcn-ui" version="0.8.0" />
        <package name="@supabase/supabase-js" version="2.86.0" />
        <package name="@tanstack/react-query" version="5.90.11" />
        <package name="resend" version="6.5.2" />
        <package name="twilio" version="5.10.6" />
      </ecosystem>
    </dependencies>
  </artifacts>

  <constraints>
    - Adherence to the exact command specified in the architecture document is critical for consistency.
    - Naming conventions: `kebab-case` for API routes, `snake_case` for database objects, `PascalCase` for React components.
    - Project Structure: Standard Next.js App Router project layout.
  </constraints>
  <interfaces>
    <!-- No existing interfaces relevant to this story. -->
  </interfaces>
  <tests>
    <standards>
      A layered testing strategy including Unit, Integration, and End-to-End (E2E) tests will be used.
      Unit tests will be written with Vitest. E2E tests will use Playwright.
      The CI pipeline on Vercel will be configured to run linting and tests on every push to the main branch.
    </standards>
    <locations>
      - Unit/Integration tests: co-located with the source files (`*.test.ts`).
      - E2E tests: in the `tests/` directory at the project root.
    </locations>
    <ideas>
      - **AC #1:**
        - Write a `Vitest` unit test to check that `package.json` contains `typescript`, `tailwindcss`, and `eslint` as dependencies.
        - Write a `Vitest` unit test to verify that `tailwind.config.ts` and `.eslintrc.json` files exist at the root.
      - **AC #2:**
        - Manual test: Confirm that the Vercel project dashboard shows the repository as connected.
      - **AC #3:**
        - After a push to a PR, inspect the Vercel deployment logs to confirm that the `lint` and `test` commands were executed.
        - Write a basic `Playwright` E2E test that navigates to the deployed Vercel URL and verifies the presence of a key element (e.g., the Next.js welcome page `<h1>`).
    </ideas>
  </tests>
</story-context>
